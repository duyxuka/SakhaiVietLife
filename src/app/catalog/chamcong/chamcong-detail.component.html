<form [formGroup]="form" (ngSubmit)="saveChange()" skipValidation>
  <p-panel #pnl header="Chi tiết chấm công">
    <!-- Form Body -->
    <ng-template pTemplate="body">
      <div class="flex flex-col gap-6 mt-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Nhân viên -->
          <div>
            <label for="nhanVienId" class="block font-bold mb-2">
              Nhân viên <span class="text-red-500">*</span>
            </label>
            <p-select
              id="nhanVienId"
              [options]="userslist"
              formControlName="nhanVienId"
              placeholder="Chọn nhân viên"
              optionLabel="name"
              optionValue="id"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              fluid
            >
              <!-- Hiển thị khi chọn -->
              <ng-template pTemplate="selectedItem" let-selected>
                <div class="flex align-items-center gap-2">
                  <img
                    src="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png"
                    alt="Avatar"
                    width="24"
                    class="border-circle"
                  />
                  <div>{{ selected?.name }}</div>
                </div>
              </ng-template>

              <!-- Hiển thị danh sách -->
              <ng-template pTemplate="item" let-item>
                <div class="flex align-items-center gap-2">
                  <img
                    src="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png"
                    alt="Avatar"
                    width="24"
                    class="border-circle"
                  />
                  <div class="font-medium">{{ item.name }}</div>
                </div>
              </ng-template>
            </p-select>
            <app-validation-message
              [entityForm]="form"
              fieldName="nhanVienId"
              [validationMessages]="validationMessages"
            />
          </div>

          <!-- Ngày làm -->
          <div>
            <label for="ngayLam" class="block font-bold mb-2">
              Ngày làm <span class="text-red-500">*</span>
            </label>
            <p-datepicker
              id="ngayLam"
              formControlName="ngayLam"
              dateFormat="dd/mm/yy"
              showIcon="true"
              placeholder="Chọn ngày làm việc"
              fluid
            ></p-datepicker>
            <app-validation-message
              [entityForm]="form"
              fieldName="ngayLam"
              [validationMessages]="validationMessages"
            />
          </div>

          <!-- Giờ vào -->
          <div>
            <label for="gioVao" class="block font-bold mb-2">Giờ vào</label>
            <p-datepicker
              id="gioVao"
              formControlName="gioVao"
              [showTime]="true"
              hourFormat="24"
              showIcon="true"
              placeholder="Chọn giờ vào"
              fluid
            ></p-datepicker>
          </div>

          <!-- Giờ ra -->
          <div>
            <label for="gioRa" class="block font-bold mb-2">Giờ ra</label>
            <p-datepicker
              id="gioRa"
              formControlName="gioRa"
              [showTime]="true"
              hourFormat="24"
              showIcon="true"
              placeholder="Chọn giờ ra"
              fluid
            ></p-datepicker>
          </div>

          <!-- Số giờ làm -->
          <div>
            <label for="soGioLam" class="block font-bold mb-2">Số giờ làm</label>
            <input
              id="soGioLam"
              type="number"
              pInputText
              formControlName="soGioLam"
              placeholder="Nhập số giờ làm"
              fluid
            />
          </div>

          <!-- Số phút đi muộn -->
          <div>
            <label for="soPhutDiMuon" class="block font-bold mb-2">Số phút đi muộn</label>
            <input
              id="soPhutDiMuon"
              type="number"
              pInputText
              formControlName="soPhutDiMuon"
              placeholder="Nhập số phút đi muộn"
              fluid
            />
          </div>

          <!-- Số phút về sớm -->
          <div>
            <label for="soPhutVeSom" class="block font-bold mb-2">Số phút về sớm</label>
            <input
              id="soPhutVeSom"
              type="number"
              pInputText
              formControlName="soPhutVeSom"
              placeholder="Nhập số phút về sớm"
              fluid
            />
          </div>

          <!-- Công ngày -->
          <div>
            <label for="congNgay" class="block font-bold mb-2">Công ngày</label>
            <input
              id="congNgay"
              type="number"
              pInputText
              formControlName="congNgay"
              placeholder="Nhập số công ngày"
              fluid
            />
          </div>

          <!-- Trạng thái -->
          <div class="flex items-center gap-3">
            <label for="trangThai" class="font-bold">Trạng thái</label>
            <p-inputSwitch formControlName="trangThai"></p-inputSwitch>
          </div>
        </div>
      </div>
    </ng-template>

    <!-- Footer -->
    <ng-template pTemplate="footer">
      <p-toolbar>
        <ng-template pTemplate="end">
          <p-button
            label="Hủy"
            icon="pi pi-times"
            severity="secondary"
            [outlined]="true"
            [rounded]="true"
            (onClick)="cancel()"
            class="mr-2"
          />
          <p-button
            type="submit"
            label="Lưu lại"
            icon="pi pi-check"
            [disabled]="!form.valid || btnDisabled"
            [loading]="btnDisabled"
          />
        </ng-template>
      </p-toolbar>
    </ng-template>

    <!-- Block UI -->
    <p-blockui [blocked]="blockedPanel" [target]="pnl">
      <p-progress-spinner style="top: 37%;" />
    </p-blockui>
  </p-panel>
</form>
