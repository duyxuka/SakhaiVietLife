<form [formGroup]="form" (ngSubmit)="saveChange()" skipValidation>
  <p-panel #pnl header="Chi tiết KPI nhân viên">
    <!-- Form Body -->
    <ng-template pTemplate="body">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
        <!-- Nhân viên -->
        <div>
          <label for="nhanVienId" class="block font-bold mb-2">
            Nhân viên <span class="text-red-500">*</span>
          </label>
          <p-select
            [options]="userslist"
            formControlName="nhanVienId"
            placeholder="Chọn nhân viên"
            [showClear]="true"
            style="width: 100%"
          ></p-select>
          <app-validation-message
            [entityForm]="form"
            fieldName="nhanVienId"
            [validationMessages]="validationMessages"
          ></app-validation-message>
        </div>

        <!-- Tháng -->
        <div>
          <label for="thang" class="block font-bold mb-2">
            Tháng <span class="text-red-500">*</span>
          </label>
          <input
            id="thang"
            type="number"
            pInputText
            formControlName="thang"
            placeholder="Nhập tháng"
            style="width: 100%"
          />
        </div>

        <!-- Năm -->
        <div>
          <label for="nam" class="block font-bold mb-2">
            Năm <span class="text-red-500">*</span>
          </label>
          <input
            id="nam"
            type="number"
            pInputText
            formControlName="nam"
            placeholder="Nhập năm"
            style="width: 100%"
          />
        </div>

        <!-- Mức lương KPI -->
        <div>
          <label for="mucLuongKpi" class="block font-bold mb-2">
            Mức lương KPI
          </label>
          <p-inputNumber
            id="mucLuongKpi"
            formControlName="mucLuongKpi"
            mode="currency"
            currency="VND"
            locale="vi-VN"
            style="width: 100%"
          ></p-inputNumber>
        </div>

        <!-- Mức xếp loại -->
        <div>
          <label for="mucXepLoai" class="block font-bold mb-2">
            Mức xếp loại
          </label>
          <p-select
            [options]="mucXepLoaiList"
            formControlName="mucXepLoai"
            placeholder="Chọn mức xếp loại"
            style="width: 100%"
          ></p-select>
        </div>

        <!-- Người đánh giá -->
        <div>
          <label for="nguoiDanhGiaId" class="block font-bold mb-2">
            Người đánh giá
          </label>
          <p-select
            [options]="userslist"
            formControlName="nguoiDanhGiaId"
            placeholder="Chọn người đánh giá"
            [showClear]="true"
            style="width: 100%"
          ></p-select>
        </div>

        <!-- Ghi chú -->
        <div class="md:col-span-2">
          <label for="ghiChu" class="block font-bold mb-2">Ghi chú</label>
          <textarea
            id="ghiChu"
            pTextarea
            formControlName="ghiChu"
            rows="3"
            placeholder="Nhập ghi chú"
            style="width: 100%"
          ></textarea>
        </div>
      </div>
    </ng-template>

    <!-- Footer với Toolbar -->
    <ng-template pTemplate="footer">
      <p-toolbar>
        <ng-template pTemplate="end">
          <p-button
            label="Hủy"
            icon="pi pi-times"
            severity="secondary"
            [outlined]="true"
            [rounded]="true"
            (onClick)="cancel()"
            class="mr-2"
          />
          <p-button
            type="submit"
            label="Lưu lại"
            icon="pi pi-check"
            [disabled]="!form.valid || btnDisabled"
            [loading]="btnDisabled"
          />
        </ng-template>
      </p-toolbar>
    </ng-template>

    <!-- Block UI -->
    <p-blockUI [blocked]="blockedPanel" [target]="pnl">
      <p-progress-spinner style="top: 37%;" />
    </p-blockUI>
  </p-panel>
</form>
